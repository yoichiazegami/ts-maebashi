<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M+ Stroke</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.js"></script>
</head>
<body>
    <div id="app-wrapper">
        <div id="main-content">
            <div id="canvas-container"></div>

            <div id="impression-overlay"></div>

            <div id="rules-modal" class="modal-overlay" style="display:none" onclick="if(event.target===this)this.style.display='none'">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>è’¸ç•™ãƒ«ãƒ¼ãƒ«</h3>
                        <button onclick="document.getElementById('rules-modal').style.display='none'">&times;</button>
                    </div>
                    <pre id="rules-text"></pre>
                </div>
            </div>

            <div id="input-area">
                <div id="input-row">
                    <textarea id="text-input" placeholder="ã“ã“ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›â€¦" rows="1"></textarea>
                    <div id="input-buttons">
                        <button id="next-text-btn" onclick="nextText()">æ–°ã—ã„ã‚µãƒ³ãƒ—ãƒ«ãƒ†ã‚­ã‚¹ãƒˆã‚’ç”Ÿæˆ</button>
                        <span class="input-divider"></span>
                        <span id="predict-label">æ–¹å¼ï¼š</span>
                        <select id="predict-mode" title="æ¨è«–ãƒ¢ãƒ¼ãƒ‰">
                            <option value="hybrid" selected>ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰</option>
                            <option value="llm">LLM</option>
                            <option value="knn">k-NN</option>
                        </select>
                    </div>
                </div>
            </div>
        </div><!-- /main-content -->

        <button id="settings-btn" onclick="document.getElementById('app-wrapper').classList.toggle('panel-open')" title="è¨­å®šãƒ‘ãƒãƒ«">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
                <line x1="3" y1="4" x2="15" y2="4"/><line x1="3" y1="9" x2="15" y2="9"/><line x1="3" y1="14" x2="15" y2="14"/>
            </svg>
        </button>

        <aside id="settings-panel">
            <input type="hidden" id="p-scaleX" value="100">
            <input type="hidden" id="p-scaleY" value="100">

            <section>
                <h4>çµ„ç‰ˆ</h4>
                <input type="hidden" id="p-fontSize" value="50">
                <div class="param">
                    <label>çµ„æ–¹å‘</label>
                    <select id="p-direction">
                        <option value="h" selected>æ¨ªçµ„</option>
                        <option value="v">ç¸¦çµ„</option>
                    </select>
                </div>
                <div class="param">
                    <label>è¡Œé–“ <span id="v-lineHeight">1.30</span></label>
                    <input type="range" id="p-lineHeight" min="1.00" max="1.70" value="1.30" step="0.05">
                </div>
                <div class="param">
                    <label>å­—é–“ <span id="v-letterSpacing">1.05</span></label>
                    <input type="range" id="p-letterSpacing" min="0.90" max="1.35" value="1.05" step="0.05">
                </div>
            </section>

            <section>
                <h4>ãƒ–ãƒ©ã‚·å½¢çŠ¶</h4>
                <div class="param">
                    <label>å¤ªã• <span id="v-strokeW">2.0</span></label>
                    <input type="range" id="p-strokeW" min="0.1" max="10" value="2" step="0.1">
                </div>
                <div class="param">
                    <label>ç«¯ã®å½¢çŠ¶</label>
                    <select id="p-lineCap">
                        <option value="round" selected>ä¸¸ (round)</option>
                        <option value="butt">å¹³ (butt)</option>
                        <option value="square">è§’ (square)</option>
                    </select>
                </div>
                <div class="param">
                    <label>ç¸¦æ¨ªã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆ <span id="v-contrast">0</span></label>
                    <input type="range" id="p-contrast" min="-500" max="500" value="0">
                </div>
            </section>

            <section>
                <h4>ã‚¢ãƒ³ã‚«ãƒ¼ãƒã‚¤ãƒ³ãƒˆ</h4>
                <div class="param">
                    <label>å¢—æ¸› <span id="v-anchorPoints">0</span></label>
                    <input type="range" id="p-anchorPoints" min="-30" max="6" value="0" step="0.5">
                </div>
            </section>

            <section>
                <h4>ãƒ‘ã‚¹å¤‰å½¢</h4>
                <div class="param">
                    <label>ç›´ç·šåŒ–</label>
                    <select id="p-linearize">
                        <option value="0" selected>ã‚ªãƒ•</option>
                        <option value="1">ã‚ªãƒ³</option>
                    </select>
                </div>
                <div class="param">
                    <label>è§’ã‚’ä¸¸ã‚ã‚‹ <span id="v-cornerRadius">0</span></label>
                    <input type="range" id="p-cornerRadius" min="0" max="40" value="0">
                </div>
                <div class="param param-toggle">
                    <label><input type="checkbox" id="p-twist-on"> ãƒ©ãƒ³ãƒ€ãƒ ãƒ»ã²ã­ã‚Š <span id="v-twist">0</span></label>
                    <input type="range" id="p-twist" min="0" max="80" value="0">
                </div>
                <div class="param param-toggle">
                    <label><input type="checkbox" id="p-roughen-on"> ãƒ©ãƒ• <span id="v-roughen">0</span></label>
                    <input type="range" id="p-roughen" min="0" max="50" value="0">
                </div>
            </section>
            <section class="actions">
                <button id="randomize-btn" onclick="randomizeParams()">ğŸ² ãƒ©ãƒ³ãƒ€ãƒ </button>
                <button id="reset-btn" onclick="resetParams()">â†© ãƒªã‚»ãƒƒãƒˆ</button>
            </section>

            <section id="impression-section">
                <h4>å°è±¡å­¦ç¿’</h4>
                <div class="impression-actions">
                    <button id="save-sample-btn" onclick="saveSample()">ä¿å­˜</button>
                    <button onclick="nextText()">ã‚¹ã‚­ãƒƒãƒ—</button>
                </div>
                <div class="impression-info">
                    <span id="sample-count">0</span> ä»¶ã®ãƒ‡ãƒ¼ã‚¿
                    <span id="model-status"></span>
                </div>
                <div class="impression-actions">
                    <button onclick="exportImpressionData()">æ›¸å‡º</button>
                    <button onclick="document.getElementById('import-file').click()">èª­è¾¼</button>
                    <button onclick="if(confirm('å…¨ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')){ImpressionModel.clearSamples();updateSampleCount();}">æ¶ˆå»</button>
                </div>
                <input type="file" id="import-file" accept=".json" style="display:none"
                       onchange="importImpressionData(this)">
                <div class="param" style="margin-top:12px">
                    <label>OpenAI API Key</label>
                    <input type="password" id="api-key-input" placeholder="sk-..." class="api-key-field">
                </div>
                <div class="impression-actions" style="margin-top:6px">
                    <button onclick="rebuildEmbeddings()">æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã«embedä»˜ä¸</button>
                </div>
                <div class="impression-actions" style="margin-top:6px">
                    <button onclick="runDistill()">è’¸ç•™ï¼ˆãƒ«ãƒ¼ãƒ«æŠ½å‡ºï¼‰</button>
                    <button onclick="showDistilledRules()">ãƒ«ãƒ¼ãƒ«é–²è¦§</button>
                </div>
                <div id="distill-status" class="impression-info" style="margin-top:4px; font-size:10px; color:#888;"></div>
            </section>
        </aside>
    </div><!-- /app-wrapper -->

    <script src="impression_model.js"></script>
    <script>
    // -------------------------------------------------------
    //  ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ³ã‚¯ï¼ˆå¤šæ§˜ãªã‚¸ãƒ£ãƒ³ãƒ«ãƒ»æ–‡ä½“ï¼‰
    // -------------------------------------------------------
    const TEXT_BANK = [
        // ãƒ‹ãƒ¥ãƒ¼ã‚¹è¦‹å‡ºã—
        "é¦–ç›¸ã€ç·Šæ€¥çµŒæ¸ˆå¯¾ç­–ã‚’ç™ºè¡¨",
        "æ–°å‹ãƒ­ã‚±ãƒƒãƒˆæ‰“ã¡ä¸Šã’æˆåŠŸ",
        "æ ªä¾¡ã€éå»æœ€é«˜å€¤ã‚’æ›´æ–°",
        "å¤§è¦æ¨¡ã‚µã‚¤ãƒãƒ¼æ”»æ’ƒã‚’æ¤œçŸ¥",
        "æ°—å€™å¤‰å‹•å¯¾ç­–ã§å›½éš›åˆæ„",
        "æ­»åˆ‘åŸ·è¡Œã€æ³¢ç´‹åºƒãŒã‚‹",
        "æš´å‹•é®åœ§ã«å‚¬æ¶™å¼¾ã‚’ä½¿ç”¨",
        // ãƒ“ã‚¸ãƒã‚¹
        "ç¬¬ä¸‰å››åŠæœŸã®æ¥­ç¸¾ã«ã¤ã„ã¦ã”å ±å‘Šç”³ã—ä¸Šã’ã¾ã™",
        "æœ¬ä»¶ã«ã¤ãã¾ã—ã¦ã€ã”æ¤œè¨ã®ã»ã©ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™",
        "æ¥æœŸã®äº‹æ¥­è¨ˆç”»ç­–å®šã«ã‚ãŸã‚Š",
        // è©©çš„è¡¨ç¾
        "æœˆã®å…‰ãŒæ°´é¢ã‚’æ¸¡ã‚‹",
        "é¢¨ã«æºã‚Œã‚‹ä¸€è¼ªã®èŠ±",
        "é ã„è¨˜æ†¶ã®ã‹ã‘ã‚‰",
        "å¤œæ˜ã‘å‰ã®é’ã„é™å¯‚",
        "é›¨ã ã‚ŒãŒçª“ã‚’å©ãåˆå¾Œ",
        "æ˜Ÿå±‘ã‚’é›†ã‚ã¦å¤œç©ºã«é‚„ã™",
        "è‚Œã«æ®‹ã‚‹æŒ‡ã®æ¸©åº¦",
        "æ±—ã°ã‚€å¤œã®åæ¯",
        // æ–‡å­¦çš„
        "ãã‚Œã¯ã€é•·ã„å†¬ã®çµ‚ã‚ã‚Šã«è¨ªã‚ŒãŸ",
        "å½¼å¥³ã¯ä½•ã‚‚è¨€ã‚ãšã€ãŸã å¾®ç¬‘ã‚“ã ",
        "é“ã¯æš—ãã€çµ‚ã‚ã‚ŠãŒè¦‹ãˆãªã‹ã£ãŸ",
        "ã™ã¹ã¦ãŒç°è‰²ã«æ²ˆã‚€è¡—ã§",
        "è¡€ã®åŒ‚ã„ãŒé‰„ã®ã‚ˆã†ã«å–‰ã‚’åˆºã—ãŸ",
        "æ„›ã—ã¦ã„ã‚‹ã¨è¨€ãˆãªã„ã¾ã¾ã€æœãŒæ¥ãŸ",
        // ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«
        "ã¾ã˜ã§ã‚„ã°ã„ï¼æœ€é«˜ã™ãã‚‹",
        "ä»Šæ—¥ã‚ã£ã¡ã‚ƒæ¥½ã—ã‹ã£ãŸã€œ",
        "ã“ã‚Œç¾å‘³ã—ã™ãã¦æ³£ã‘ã‚‹",
        "ã¡ã‚‡ã£ã¨å¾…ã£ã¦www",
        "ãªã«ãã‚Œè¶…ã‚¦ã‚±ã‚‹ã‚“ã ã‘ã©",
        "ãŠã¤ã‹ã‚Œã€œä»Šæ—¥ã‚‚ãŒã‚“ã°ã£ãŸ",
        "ã‚¯ã‚½ãƒ¯ãƒ­ã‚¿",
        "ã¯ï¼Ÿæ„å‘³ã‚ã‹ã‚“ãªã„ã‚“ã ã‘ã©",
        // ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼
        "é‡å­ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ãŒå®Ÿç”¨åŒ–ã¸",
        "AIãŒå‰µé€ æ€§ã‚’ç²å¾—ã™ã‚‹æ—¥",
        "ãƒ¡ã‚¿ãƒãƒ¼ã‚¹ãŒå¤‰ãˆã‚‹åƒãæ–¹",
        "æ¬¡ä¸–ä»£åŠå°ä½“ã®é–‹ç™ºç«¶äº‰",
        "ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ã®æ–°ãŸãªå¯èƒ½æ€§",
        // å¤å…¸ãƒ»ä¼çµ±
        "èŠ±é³¥é¢¨æœˆ",
        "ä¸€æœŸä¸€ä¼š",
        "ä¾˜ã³å¯‚ã³ã®ç¾å­¦",
        "æœˆã¯æ±ã«æ—¥ã¯è¥¿ã«",
        "æ˜¥ã¯ã‚ã‘ã¼ã®",
        "è¡Œãå·ã®æµã‚Œã¯çµ¶ãˆãšã—ã¦",
        "è‰²ã¯åŒ‚ã¸ã©æ•£ã‚Šã¬ã‚‹ã‚’",
        // åŠ›å¼·ã„
        "é™ç•Œã‚’è¶…ãˆã‚",
        "çµ¶å¯¾ã«è«¦ã‚ãªã„",
        "é‰„ã®æ„å¿—ã§æŒ‘ã‚€",
        "åµã‚’åˆ‡ã‚Šè£‚ãè¦šæ‚Ÿ",
        "é­‚ã‚’ç‡ƒã‚„ã›",
        "é©å‘½ã®ç‹¼ç…™ã‚’ä¸Šã’ã‚ˆ",
        "é»™ã£ã¦å¾“ã†ãªã€å«ã¹",
        // æŸ”ã‚‰ã‹ã„
        "ãµã‚ãµã‚ã®ã—ã‚ã‚ã›",
        "ã¾ã‚‹ãã¦ã‚„ã•ã—ã„ä¸–ç•Œ",
        "ã‚„ã‚ã‚‰ã‹ãªé™½ã ã¾ã‚Š",
        "ã‚‚ã“ã‚‚ã“ã®é›²ã«åŒ…ã¾ã‚Œã¦",
        "ãã£ã¨æ‰‹ã‚’å·®ã—ä¼¸ã¹ã‚‹",
        // é™è¬
        "æ²ˆé»™ãŒèªã‚Šã‹ã‘ã‚‹",
        "å‡ªã®æµ·ã‚’è¦‹ã¤ã‚ã¦",
        "æ™‚ãŒæ­¢ã¾ã£ãŸã‚ˆã†ãªéƒ¨å±‹",
        "é™å¯‚ã®ä¸­ã®æ¯é£ã„",
        "èª°ã‚‚ã„ãªã„å›³æ›¸é¤¨",
        // è£…é£¾çš„
        "çµ¢çˆ›è±ªè¯ãªå®®æ®¿",
        "è¯éº—ãªã‚‹ä¸€æ—ã®ç‰©èª",
        "å£®éº—ãªå¤§è–å ‚ã®å¤©äº•ç”»",
        "æ¥µå½©è‰²ã®ä¸‡è¯é¡",
        // ç°¡ç´ 
        "ç™½ã„å£ã€‚æœ¨ã®æ¤…å­ã€‚",
        "ä½™ç™½ã‚’æ„›ã™ã‚‹",
        "å¼•ãç®—ã®ç¾å­¦",
        "ä½•ã‚‚ãªã„ã€ã ã‹ã‚‰ç¾ã—ã„",
        // åºƒå‘Šã‚³ãƒ”ãƒ¼é¢¨
        "ã‚ãªãŸã®æ¯æ—¥ã«ã€å°ã•ãªé©å‘½ã‚’ã€‚",
        "ãã®ä¸€æ¯ãŒã€ä¸–ç•Œã‚’å¤‰ãˆã‚‹ã€‚",
        "æœªæ¥ã¯ã€ã‚‚ã†å§‹ã¾ã£ã¦ã„ã‚‹ã€‚",
        "ã™ã¹ã¦ã®æŒ‘æˆ¦è€…ã«ã€å…‰ã‚’ã€‚",
        "ã“ã“ã‹ã‚‰ã€æ–°ã—ã„ç‰©èªãŒå§‹ã¾ã‚‹ã€‚",
        // å¤šæ§˜ãªæ–‡ä½“
        "æœ¬æ—¥ã¯æ™´å¤©ãªã‚Š",
        "å¾è¼©ã¯çŒ«ã§ã‚ã‚‹",
        "æ¡œæ•£ã‚‹å­£ç¯€ã®ç§»ã‚ã„",
        "ãƒ‡ãƒ¼ã‚¿ãŒç¤ºã™çœŸå®Ÿ",
        "æš—å·é€šè²¨ã®å¤œæ˜ã‘",
        "æ‰‹ç´™ã‚’æ›¸ãã¨ã„ã†ã“ã¨",
        "çˆç²ä¸€æ¯ã®è´…æ²¢",
        // éæ¿€ãƒ»æš´åŠ›çš„
        "æ®ºã—ã¦ã‚„ã‚‹",
        "è¡€ã¾ã¿ã‚Œã®æ‹³ã§ç«‹ã¡ä¸ŠãŒã‚‹",
        "å¾©è®ã®åˆƒã‚’ç ”ã",
        "ã“ã®ä¸–ã®åœ°ç„ã‚’è¦‹ãŸ",
        "æˆ¦å ´ã®å«ã³å£°ãŒè€³ã‚’é›¢ã‚Œãªã„",
        "æ­»ã­ã€ã¨å‘Ÿã„ãŸå”‡",
        // å®˜èƒ½çš„ãƒ»è€½ç¾
        "çµ¡ã¿åˆã†ç´ è‚Œã®ç†±",
        "å”‡ãŒè§¦ã‚ŒãŸç¬é–“ã€ä¸–ç•ŒãŒæº¶ã‘ãŸ",
        "ç¦æ–­ã®æœå®Ÿã«æ‰‹ã‚’ä¼¸ã°ã™",
        "èœœã®ã‚ˆã†ã«ç”˜ã„ç—›ã¿",
        "èƒŒå¾³ã®é¦™ã‚Šã«é…”ã†å¤œ",
        "æ¿¡ã‚ŒãŸé«ªã‚’æ»ãä¸Šã’ã‚‹æŒ‡å…ˆ",
        "ä¹±ã‚ŒãŸå¯å…·ã®ä¸Šã®æ²ˆé»™",
        // ãƒ€ãƒ¼ã‚¯ãƒ»é€€å»ƒ
        "è…æ•—ã—ãŸæ¥½åœ’ã¸ã‚ˆã†ã“ã",
        "ç‹‚æ°—ã¯é™ã‹ã«å¾®ç¬‘ã‚€",
        "æ¯’ã‚’é£²ã¿å¹²ã™ã‚ˆã†ãªæ„›",
        "åœ°ç„ã®åº•ã§ç¥ã‚’å—¤ã†",
        "æ£ºæ¡¶ã®ä¸­ã¯ã¨ã¦ã‚‚é™ã‹ã ",
        "åãæ°—ãŒã™ã‚‹ã»ã©ç¾ã—ã„",
        // ãƒ›ãƒ©ãƒ¼ãƒ»æ€ªå¥‡
        "æŒ¯ã‚Šå‘ã„ãŸã‚‰ã€ãã“ã«ã„ãŸ",
        "å£ã®ä¸­ã‹ã‚‰çˆªã§å¼•ã£æ»ãéŸ³",
        "é¡ã«æ˜ ã‚‹ã®ã¯ç§ã§ã¯ãªã‹ã£ãŸ",
        "é¦–ã®ãªã„äººå½¢ãŒç¬‘ã£ã¦ã„ã‚‹",
        "ã‚ã®å­ã¯ã‚‚ã†ä¸‰å¹´å‰ã«æ­»ã‚“ã§ã„ã‚‹",
        // ã‚µãƒ–ã‚«ãƒ«ãƒãƒ£ãƒ¼ãƒ»ãƒ‹ãƒƒãƒ
        "æ¨ã—ãŒå°Šã™ãã¦æ˜‡å¤©",
        "é™ç•Œã‚ªã‚¿ã‚¯ã®å«ã³",
        "æ¦‚å¿µãŒå…·ç¾åŒ–ã—ãŸå­˜åœ¨",
        "è§£é‡ˆé•ã„ã§å®‡å®™ãŒå‰²ã‚Œã‚‹",
        "ç•Œéšˆæœ€å¤§æ‰‹ã®è¦‡æ¨©ã‚³ãƒ³ãƒ†ãƒ³ãƒ„",
        "æ€§ç™–ã«åˆºã•ã‚Šã™ãã¦ç„¡ç†",
        "ã‚¬ãƒæ‹å‹¢ã®æœ«è·¯",
        // ç½µå€’ãƒ»æ¯’èˆŒ
        "é»™ã‚Œã€æ„šã‹è€…",
        "ãã®ç¨‹åº¦ã‹ã€å¤±æœ›ã—ãŸ",
        "ãã ã‚‰ãªã„ã€‚å®Ÿã«ãã ã‚‰ãªã„",
        "ãŠå‰ã«äººã®å¿ƒã¯ã‚ã‚‹ã®ã‹",
        "åãæ°—ãŒã™ã‚‹å½å–„è€…ã‚",
        // å®—æ•™ãƒ»å‘ªè¡“ãƒ»ç¥ç§˜
        "æ±ã€ç½ªã‚’æ‚”ã„æ”¹ã‚ã‚ˆ",
        "å—ç„¡é˜¿å¼¥é™€ä»",
        "å‘ªã„ã¯è§£ã‘ãªã„",
        "ç¥ã¯æ²ˆé»™ã—ã¦ã„ã‚‹",
        "ç¥ˆã‚Šã®è¨€è‘‰ã¯é—‡ã«æº¶ã‘ãŸ",
        "é­”è¡“å›è·¯ã‚’èµ·å‹•ã™ã‚‹",
        // æ¨™è­˜ãƒ»æ³¨æ„æ›¸ã
        "ã“ã®å…ˆé€šè¡Œæ­¢ã‚",
        "é«˜åœ§é›»æµæ³¨æ„ã€€è§¦ã‚Œã‚‹ãª",
        "ç«‹å…¥ç¦æ­¢åŒºåŸŸ",
        "æ¯’ç‰©ã€€å–æ‰±æ³¨æ„",
        "éå¸¸å£ã¯ã“ã¡ã‚‰",
        // å“²å­¦çš„
        "å­˜åœ¨ã¨ã¯ä½•ã‹",
        "æˆ‘æ€ã†ã€ã‚†ãˆã«æˆ‘ã‚ã‚Š",
        "è¨€è‘‰ã«ã§ããªã„ã‚‚ã®ã‚’èªã‚‹çŸ›ç›¾",
        "ç„¡ã¯å­˜åœ¨ã™ã‚‹ã‹",
        "è‡ªç”±ã¨ã„ã†åã®ç‰¢ç„",
        // ã‚°ãƒ­ãƒ†ã‚¹ã‚¯ãƒ»èº«ä½“
        "å†…è‡“ãŒé€ã‘ã¦è¦‹ãˆã‚‹å…‰",
        "çš®è†šã®ä¸‹ã§è ¢ãã‚‚ã®",
        "éª¨ãŒè»‹ã‚€éŸ³ãŒã™ã‚‹",
        "çœ¼çƒã«æ˜ ã‚‹æœ€å¾Œã®æ™¯è‰²",
        // ãƒŠãƒ³ã‚»ãƒ³ã‚¹ãƒ»ä¸æ¡ç†
        "ç«æ›œæ—¥ã®å‘³ãŒã™ã‚‹",
        "é€æ˜ãªå«ã³å£°ã‚’æ‹¾ã†",
        "æ°¸é ã¯æ˜¨æ—¥çµ‚ã‚ã£ãŸ",
        "ä¸‰è§’å½¢ã®æ„Ÿæƒ…",
        "æ²ˆé»™ã‚’éŸ³èª­ã™ã‚‹",
    ];

    function getRandomText() {
        return TEXT_BANK[Math.floor(Math.random() * TEXT_BANK.length)];
    }

    // LLMç”Ÿæˆãƒ†ã‚­ã‚¹ãƒˆã®ãƒãƒƒãƒ•ã‚¡
    let _generatedTexts = [];
    let _generating = false;

    async function fillTextBuffer() {
        if (_generating || !ImpressionModel.getApiKey()) return;
        _generating = true;
        const overlay = document.getElementById('impression-overlay');
        overlay.textContent = 'â³ ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆä¸­â€¦';
        try {
            const texts = await ImpressionModel.generateTexts(10);
            if (texts && texts.length > 0) {
                _generatedTexts = _generatedTexts.concat(texts);
                overlay.textContent = 'âœ“ ' + texts.length + 'ä»¶ã®ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆå®Œäº†';
            } else {
                overlay.textContent = '';
            }
        } catch (e) {
            console.warn('Text generation error:', e);
        }
        _generating = false;
    }

    function nextText() {
        const textarea = document.getElementById('text-input');
        if (_generatedTexts.length > 0) {
            textarea.value = _generatedTexts.shift();
            if (_generatedTexts.length < 3) fillTextBuffer();
        } else {
            textarea.value = getRandomText();
            if (ImpressionModel.getApiKey()) fillTextBuffer();
        }
        textarea.dispatchEvent(new Event('input'));
    }

    // -------------------------------------------------------
    //  ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼åˆ¶å¾¡
    // -------------------------------------------------------
    function updateLabel(el) {
        const id = el.id.replace('p-', 'v-');
        const span = document.getElementById(id);
        if (!span) return;
        const v = el.value;
        if (id.includes('scale')) span.textContent = v + '%';
        else if (id.includes('contrast')) span.textContent = (v >= 0 ? '+' : '') + v;
        else span.textContent = v;
    }
    document.querySelectorAll('#settings-panel input[type=range]').forEach(el => {
        el.addEventListener('input', () => updateLabel(el));
    });

    document.querySelectorAll('.param-toggle input[type=checkbox]').forEach(cb => {
        const param = cb.closest('.param-toggle');
        const sync = () => param.classList.toggle('active', cb.checked);
        cb.addEventListener('change', sync);
        sync();
    });

    function randBetween(a, b) { return a + Math.random() * (b - a); }
    function randInt(a, b) { return Math.round(randBetween(a, b)); }

    function randomizeParams() {
        const sets = {
            'p-lineHeight':   () => (randBetween(1.0, 1.7)).toFixed(2),
            'p-letterSpacing': () => (randBetween(0.9, 1.35)).toFixed(2),
            'p-strokeW':      () => (randBetween(0.3, 10)).toFixed(1),
            'p-contrast':     () => randInt(-300, 300),
            'p-anchorPoints': () => (randBetween(-10, 4) * 2 | 0) / 2,
            'p-cornerRadius': () => randInt(0, 40),
        };
        for (const [id, fn] of Object.entries(sets)) {
            const el = document.getElementById(id);
            if (el) { el.value = fn(); updateLabel(el); }
        }
        const caps = ['round', 'butt', 'square'];
        document.getElementById('p-lineCap').value = caps[randInt(0, 2)];
        document.getElementById('p-linearize').value = Math.random() < 0.25 ? '1' : '0';

        const twistOn = Math.random() < 0.25;
        document.getElementById('p-twist-on').checked = twistOn;
        if (twistOn) {
            const el = document.getElementById('p-twist');
            el.value = randInt(5, 40);
            updateLabel(el);
        }
        const roughOn = Math.random() < 0.25;
        document.getElementById('p-roughen-on').checked = roughOn;
        if (roughOn) {
            const el = document.getElementById('p-roughen');
            el.value = randInt(3, 25);
            updateLabel(el);
        }
        document.querySelectorAll('.param-toggle input[type=checkbox]').forEach(cb => {
            cb.closest('.param-toggle').classList.toggle('active', cb.checked);
        });
    }

    function resetParams() {
        const defs = {
            'p-lineHeight':'1.30','p-letterSpacing':'1.05',
            'p-strokeW':'2','p-contrast':'0','p-anchorPoints':'0',
            'p-cornerRadius':'0','p-twist':'0','p-roughen':'0'
        };
        for (const [id, v] of Object.entries(defs)) {
            const el = document.getElementById(id);
            if (el) { el.value = v; updateLabel(el); }
        }
        document.getElementById('p-lineCap').value = 'round';
        document.getElementById('p-direction').value = 'h';
        document.getElementById('p-linearize').value = '0';
        document.getElementById('p-twist-on').checked = false;
        document.getElementById('p-roughen-on').checked = false;
        document.querySelectorAll('.param-toggle input[type=checkbox]').forEach(cb => {
            cb.closest('.param-toggle').classList.toggle('active', cb.checked);
        });
    }

    // -------------------------------------------------------
    //  ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼å–å¾—
    // -------------------------------------------------------
    function getCurrentParamsForSave() {
        return {
            lineHeight:    parseFloat(document.getElementById('p-lineHeight').value),
            letterSpacing: parseFloat(document.getElementById('p-letterSpacing').value),
            strokeW:       parseFloat(document.getElementById('p-strokeW').value),
            lineCap:       document.getElementById('p-lineCap').value,
            contrast:      parseFloat(document.getElementById('p-contrast').value),
            anchorPoints:  parseFloat(document.getElementById('p-anchorPoints').value),
            linearize:     parseFloat(document.getElementById('p-linearize').value),
            cornerRadius:  parseFloat(document.getElementById('p-cornerRadius').value),
            twist:         document.getElementById('p-twist-on').checked ? parseFloat(document.getElementById('p-twist').value) : 0,
            roughen:       document.getElementById('p-roughen-on').checked ? parseFloat(document.getElementById('p-roughen').value) : 0,
        };
    }

    // -------------------------------------------------------
    //  ä¿å­˜ï¼ˆãƒ†ã‚­ã‚¹ãƒˆ + ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ + embeddingï¼‰
    // -------------------------------------------------------
    async function saveSample() {
        const text = document.getElementById('text-input').value.trim();
        if (!text) { alert('ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'); return; }

        const params = getCurrentParamsForSave();

        let embedding = null;
        const btn = document.getElementById('save-sample-btn');
        if (ImpressionModel.getApiKey()) {
            btn.textContent = 'å–å¾—ä¸­â€¦';
            btn.disabled = true;
            try {
                embedding = await ImpressionModel.getEmbedding(text);
            } catch (e) {
                console.warn('embeddingå–å¾—ã‚¨ãƒ©ãƒ¼:', e);
            }
            btn.textContent = 'ä¿å­˜';
            btn.disabled = false;
        }

        const count = ImpressionModel.addSample(text, params, embedding);
        if (count < 0) return;
        updateSampleCount();
        updateDistillStatus();
        nextText();
        randomizeParams();
    }

    function updateSampleCount() {
        const samples = ImpressionModel.loadSamples();
        document.getElementById('sample-count').textContent = samples.length;
        const embCount = samples.filter(s => s.embedding).length;
        let status = `${samples.length}ä»¶`;
        if (embCount > 0) status += ` (embed:${embCount})`;
        document.getElementById('model-status').textContent = status;
    }

    function exportImpressionData() {
        const json = ImpressionModel.exportSamples();
        const blob = new Blob([json], { type: 'application/json' });
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = 'impression_samples.json';
        a.click();
    }

    function importImpressionData(input) {
        const file = input.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = () => {
            if (ImpressionModel.importSamples(reader.result)) {
                updateSampleCount();
                alert('ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ');
            } else {
                alert('ãƒ‡ãƒ¼ã‚¿å½¢å¼ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“');
            }
        };
        reader.readAsText(file);
        input.value = '';
    }

    // -------------------------------------------------------
    //  æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã«embeddingä»˜ä¸
    // -------------------------------------------------------
    async function rebuildEmbeddings() {
        if (!ImpressionModel.getApiKey()) { alert('APIã‚­ãƒ¼ã‚’å…ˆã«è¨­å®šã—ã¦ãã ã•ã„'); return; }
        const samples = ImpressionModel.loadSamples();
        const need = samples.filter(s => s.text && !s.embedding);
        if (need.length === 0) { alert('å…¨ãƒ‡ãƒ¼ã‚¿ã«embeddingã‚ã‚Š'); return; }
        const overlay = document.getElementById('impression-overlay');
        let done = 0;
        for (const s of need) {
            overlay.textContent = `embedä»˜ä¸ä¸­â€¦ ${++done}/${need.length}`;
            try {
                const emb = await ImpressionModel.getEmbedding(s.text);
                if (emb) s.embedding = emb;
            } catch (e) { console.warn('embed error:', e); }
            await new Promise(r => setTimeout(r, 1500));
        }
        ImpressionModel.saveSamples(samples);
        updateSampleCount();
        overlay.textContent = `âœ“ ${done}ä»¶ã«embedä»˜ä¸å®Œäº†`;
    }

    // -------------------------------------------------------
    //  ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼æ¨è–¦ã®é©ç”¨ï¼ˆæ»‘ã‚‰ã‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
    // -------------------------------------------------------
    let _paramAnimId = null;

    function applyRecommendedParams(params) {
        if (!params) return;
        if (_paramAnimId) cancelAnimationFrame(_paramAnimId);

        const numTargets = {
            'p-lineHeight':    params.lineHeight,
            'p-letterSpacing': params.letterSpacing,
            'p-strokeW':       params.strokeW,
            'p-contrast':      params.contrast,
            'p-anchorPoints':  params.anchorPoints,
            'p-cornerRadius':  params.cornerRadius,
            'p-twist':         params.twist || 0,
            'p-roughen':       params.roughen || 0,
        };

        const starts = {};
        for (const id of Object.keys(numTargets)) {
            const el = document.getElementById(id);
            starts[id] = el ? parseFloat(el.value) || 0 : 0;
        }

        // é›¢æ•£ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¯å³æ™‚é©ç”¨
        document.getElementById('p-lineCap').value = params.lineCap || 'round';
        document.getElementById('p-linearize').value = params.linearize ? '1' : '0';

        const twistOn = (params.twist || 0) > 0;
        document.getElementById('p-twist-on').checked = twistOn;
        const roughOn = (params.roughen || 0) > 0;
        document.getElementById('p-roughen-on').checked = roughOn;
        document.querySelectorAll('.param-toggle input[type=checkbox]').forEach(cb => {
            cb.closest('.param-toggle').classList.toggle('active', cb.checked);
        });

        const duration = 400;
        const startTime = performance.now();

        function easeOut(t) { return 1 - (1 - t) * (1 - t); }

        function formatVal(id, v) {
            if (id === 'p-lineHeight' || id === 'p-letterSpacing') return v.toFixed(2);
            if (id === 'p-strokeW') return v.toFixed(1);
            if (id === 'p-anchorPoints') return (Math.round(v * 2) / 2).toFixed(1);
            return Math.round(v).toString();
        }

        function tick(now) {
            const elapsed = now - startTime;
            const t = Math.min(elapsed / duration, 1);
            const ease = easeOut(t);

            for (const [id, target] of Object.entries(numTargets)) {
                const el = document.getElementById(id);
                if (!el) continue;
                const current = starts[id] + (target - starts[id]) * ease;
                el.value = formatVal(id, current);
                updateLabel(el);
            }

            if (t < 1) {
                _paramAnimId = requestAnimationFrame(tick);
            } else {
                _paramAnimId = null;
            }
        }

        _paramAnimId = requestAnimationFrame(tick);
    }

    // -------------------------------------------------------
    //  ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è‡ªå‹•æ¨è–¦ï¼ˆLLM â†’ k-NNï¼‰
    // -------------------------------------------------------
    let _autoTimer = null;

    function setCanvasBlur(on) {
        const container = document.getElementById('canvas-container');
        if (on) {
            // ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã«å¿œã˜ã¦ã¼ã‹ã—é‡ã‚’èª¿æ•´ï¼ˆå¤§ãã„æ–‡å­—ã¯å¼·ãã€å°ã•ã„æ–‡å­—ã¯è»½ãï¼‰
            const fontSize = parseFloat(document.getElementById('p-fontSize')?.value || 50);
            const txt = document.getElementById('text-input')?.value || '';
            const lines = txt.split('\n');
            const maxLen = Math.max(1, ...lines.map(l => l.length));
            const availW = container.clientWidth - 80;
            const estSize = Math.min(availW / (maxLen * 1.05), fontSize * 5);
            const blur = Math.max(3, Math.min(16, estSize * 0.08));
            container.style.filter = `blur(${blur.toFixed(1)}px)`;
        } else {
            container.style.filter = 'blur(0px)';
        }
    }

    async function autoSuggest() {
        const overlay = document.getElementById('impression-overlay');
        const mode = document.getElementById('predict-mode').value;
        const container = document.getElementById('canvas-container');
        try {
            const text = document.getElementById('text-input').value;
            if (!text.trim()) { overlay.textContent = ''; setCanvasBlur(false); return; }

            const apiKey = ImpressionModel.getApiKey();
            if (!apiKey) {
                overlay.textContent = 'âš  è¨­å®šãƒ‘ãƒãƒ«ä¸‹éƒ¨ã«OpenAI APIã‚­ãƒ¼ã‚’å…¥åŠ›';
                return;
            }

            setCanvasBlur(true);

            if (mode === 'hybrid') {
                // â”€â”€ ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ãƒ¢ãƒ¼ãƒ‰ (k-NNé¡ä¼¼æ¤œç´¢ â†’ LLMå¾®èª¿æ•´) â”€â”€
                overlay.textContent = 'â³ ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰åˆ†æä¸­â€¦';

                const result = await ImpressionModel.predictByHybrid(text, msg => {
                    overlay.textContent = msg;
                });

                if (result && result.params) {
                    applyRecommendedParams(result.params);
                    overlay.textContent = 'âœ“ [hybrid] ' + (result.reasoning || 'æ¨è«–å®Œäº†');
                    setCanvasBlur(false);
                    return;
                }

                const hErr = result ? (result.error || '') : '';
                overlay.textContent = 'âš  hybrid: ' + hErr;
                setCanvasBlur(false);

            } else if (mode === 'knn') {
                // â”€â”€ k-NN ãƒ¢ãƒ¼ãƒ‰ â”€â”€
                overlay.textContent = 'â³ k-NN: embeddingå–å¾—ä¸­â€¦';
                const embedding = await ImpressionModel.getEmbedding(text);
                const samples = ImpressionModel.loadSamples();
                const embCount = samples.filter(s => s.embedding).length;
                if (!embedding) {
                    overlay.textContent = 'âš  k-NN: embeddingå–å¾—å¤±æ•—';
                    setCanvasBlur(false);
                    return;
                }
                if (embCount === 0) {
                    overlay.textContent = 'âš  k-NN: å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã«embeddingãªã—ï¼ˆembedä»˜ä¸ã—ã¦ãã ã•ã„ï¼‰';
                    setCanvasBlur(false);
                    return;
                }
                const knnResult = ImpressionModel.predictByEmbedding(embedding, samples);
                if (knnResult && knnResult.params) {
                    applyRecommendedParams(knnResult.params);
                    overlay.textContent = 'âœ“ [k-NN] ' + knnResult.reasoning;
                } else {
                    overlay.textContent = 'âš  k-NN: é¡ä¼¼ãƒ†ã‚­ã‚¹ãƒˆãªã— (embed:' + embCount + 'ä»¶)';
                }
                setCanvasBlur(false);
            } else {
                // â”€â”€ LLM ãƒ¢ãƒ¼ãƒ‰ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: k-NNï¼‰â”€â”€
                overlay.textContent = 'â³ LLMåˆ†æä¸­â€¦';

                const result = await ImpressionModel.predictByLLM(text, msg => {
                    overlay.textContent = msg;
                });
                console.log('predictByLLM result:', JSON.stringify(result).substring(0, 300));

                if (result && result.params) {
                    applyRecommendedParams(result.params);
                    overlay.textContent = 'âœ“ [LLM] ' + (result.reasoning || 'æ¨è«–å®Œäº†');
                    setCanvasBlur(false);
                    return;
                }

                const errMsg = result ? (result.error || JSON.stringify(result).substring(0, 50)) : 'nullè¿”å´';
                overlay.textContent = 'âš  LLM: ' + errMsg + ' â†’ k-NNãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯â€¦';

                const embedding = await ImpressionModel.getEmbedding(text);
                const samples = ImpressionModel.loadSamples();
                const embCount = samples.filter(s => s.embedding).length;

                if (embedding && embCount > 0) {
                    const knnResult = ImpressionModel.predictByEmbedding(embedding, samples);
                    if (knnResult && knnResult.params) {
                        applyRecommendedParams(knnResult.params);
                        overlay.textContent = 'âœ“ [k-NN] ' + knnResult.reasoning;
                        setCanvasBlur(false);
                        return;
                    }
                    overlay.textContent = 'âš  k-NN: é¡ä¼¼ãƒ†ã‚­ã‚¹ãƒˆãªã— (embed:' + embCount + 'ä»¶)';
                } else {
                    overlay.textContent = 'âš  k-NN: embed=' + embCount + 'ä»¶ / LLM: ' + errMsg;
                }
                setCanvasBlur(false);
            }
        } catch (e) {
            console.error('autoSuggest error:', e);
            overlay.textContent = 'âŒ ã‚¨ãƒ©ãƒ¼: ' + e.message;
            setCanvasBlur(false);
        }
    }

    document.getElementById('text-input').addEventListener('input', () => {
        setCanvasBlur(true);
        clearTimeout(_autoTimer);
        _autoTimer = setTimeout(() => { autoSuggest(); }, 500);
    });

    // ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿æ™‚ã«å³åº§ã«å†æ¨è«–
    document.getElementById('predict-mode').addEventListener('change', () => {
        const text = document.getElementById('text-input').value;
        if (!text.trim()) return;
        clearTimeout(_autoTimer);
        _autoTimer = setTimeout(() => { autoSuggest(); }, 100);
    });

    // -------------------------------------------------------
    //  APIã‚­ãƒ¼ç®¡ç†
    // -------------------------------------------------------
    const apiKeyInput = document.getElementById('api-key-input');
    apiKeyInput.value = ImpressionModel.getApiKey();
    apiKeyInput.addEventListener('change', () => {
        ImpressionModel.setApiKey(apiKeyInput.value);
    });


    // -------------------------------------------------------
    //  è’¸ç•™ï¼ˆPrompt Distillationï¼‰
    // -------------------------------------------------------
    async function runDistill() {
        const statusEl = document.getElementById('distill-status');
        const overlay = document.getElementById('impression-overlay');
        if (!ImpressionModel.getApiKey()) {
            alert('APIã‚­ãƒ¼ã‚’å…ˆã«è¨­å®šã—ã¦ãã ã•ã„');
            return;
        }
        statusEl.textContent = 'è’¸ç•™å®Ÿè¡Œä¸­â€¦';
        overlay.textContent = 'â³ è’¸ç•™ä¸­â€¦ å…¨ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ã¦ã„ã¾ã™';

        const result = await ImpressionModel.distillRules(msg => {
            overlay.textContent = msg;
        });

        if (result && result.rules) {
            statusEl.textContent = `âœ“ è’¸ç•™å®Œäº† (${result.sampleCount}ä»¶ã‹ã‚‰æŠ½å‡º)`;
            overlay.textContent = 'âœ“ è’¸ç•™å®Œäº† â€” ãƒ«ãƒ¼ãƒ«ãŒãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«åæ˜ ã•ã‚Œã¾ã™';
            console.log('Distilled rules:\n', result.rules);
        } else {
            const err = result ? result.error : 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼';
            statusEl.textContent = 'âš  è’¸ç•™å¤±æ•—: ' + err;
            overlay.textContent = 'âš  è’¸ç•™å¤±æ•—: ' + err;
        }
    }

    function showDistilledRules() {
        const stored = ImpressionModel.loadDistilledRules();
        const modal = document.getElementById('rules-modal');
        const textEl = document.getElementById('rules-text');
        if (!stored || !stored.rules) {
            textEl.textContent = 'ã¾ã è’¸ç•™ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚\nã€Œè’¸ç•™ï¼ˆãƒ«ãƒ¼ãƒ«æŠ½å‡ºï¼‰ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚';
        } else {
            const date = new Date(stored.timestamp);
            const header = `[${stored.sampleCount}ä»¶ã®ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æŠ½å‡º â€” ${date.toLocaleString('ja-JP')}]\n\n`;
            textEl.textContent = header + stored.rules;
        }
        modal.style.display = 'flex';
    }

    function updateDistillStatus() {
        const statusEl = document.getElementById('distill-status');
        const stored = ImpressionModel.loadDistilledRules();
        if (stored) {
            const ago = Math.round((Date.now() - stored.timestamp) / 60000);
            const agoStr = ago < 60 ? `${ago}åˆ†å‰` : `${Math.round(ago / 60)}æ™‚é–“å‰`;
            statusEl.textContent = `è’¸ç•™æ¸ˆã¿ (${stored.sampleCount}ä»¶, ${agoStr})`;
            if (ImpressionModel.needsRedistill()) {
                statusEl.textContent += ' â€” å†è’¸ç•™æ¨å¥¨';
            }
        } else {
            const count = ImpressionModel.loadSamples().length;
            if (count >= 10) {
                statusEl.textContent = 'æœªè’¸ç•™ â€” ã€Œè’¸ç•™ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„';
            } else {
                statusEl.textContent = `ãƒ‡ãƒ¼ã‚¿ ${count}/10ä»¶ï¼ˆè’¸ç•™ã«ã¯10ä»¶ä»¥ä¸Šå¿…è¦ï¼‰`;
            }
        }
    }

    // ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚¯ãƒªãƒƒã‚¯ã§ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
    document.getElementById('canvas-container').addEventListener('click', () => {
        document.getElementById('text-input').focus();
    });

    // åˆæœŸåŒ–
    ImpressionModel.cleanupOldKeys();
    ImpressionModel.ensureDefaultSamples().then(() => {
        updateSampleCount();
        updateDistillStatus();
    });
    </script>
    <script src="sketches/sketch1/sketch.js"></script>
</body>
</html>
